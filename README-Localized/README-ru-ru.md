# Art Curator для Windows Phone

В этом примере показано, как извлекать сообщения и вложения из Office 365 с помощью API Почты Outlook. Это приложение создано для [iOS](https://github.com/OfficeDev/O365-iOS-ArtCurator), [Android](https://github.com/OfficeDev/O365-Android-ArtCurator), [веб-браузеров (веб-приложение на платформе Angular)](https://github.com/OfficeDev/O365-Angular-ArtCurator) и Windows Phone. Просмотрите [статью на сайте Medium](https://medium.com/office-app-development).

Art Curator воплощает новый подход к просмотру папки "Входящие". Представьте, что вы владеете компанией, которая продает дизайнерские футболки. Как владелец компании вы получаете много сообщений с рисунками от художников. Вместо того чтобы использовать Outlook и открывать каждое сообщение отдельно, скачивать вложенный рисунок и открывать его для просмотра, можно использовать Art Curator для просмотра вложений (только файлы JPG и PNG) из папки "Входящие". Таким образом выбирать понравившиеся рисунки намного удобнее.

[![Art Curator Screenshot](../README Assets/AC_WinPhone.png)](https://youtu.be/4LOvkweDfhY "Click to see the sample in action.")

В этом примере демонстрируются следующие операции из **API Почты Outlook**:
* [Извлечение папок](https://msdn.microsoft.com/office/office365/APi/mail-rest-operations#GetFolders)
* [Извлечение сообщений](https://msdn.microsoft.com/office/office365/APi/mail-rest-operations#Getmessages) (в том числе фильтрация и использование выборки) 
* [Извлечение вложений](https://msdn.microsoft.com/office/office365/APi/mail-rest-operations#GetAttachments)
* [Обновление сообщений](https://msdn.microsoft.com/office/office365/APi/mail-rest-operations#Updatemessages)
* [Создание и отправка сообщений](https://msdn.microsoft.com/office/office365/APi/mail-rest-operations#Sendmessages) (с вложением или без него) 

<a name="prerequisites"></a>
## Необходимые компоненты

Для этого примера требуются следующие компоненты:  

  — Windows 8.1
  — Visual Studio 2013 с обновлением 3
  — [Средства API Office 365 версии 1.4.50428.2](http://aka.ms/k0534n)
  — [Сайт разработчика Office 365](http://aka.ms/ro9c62)
  — [Учетная запись разработчика приложений для Windows](https://appdev.microsoft.com/StorePortals/ru-ru/Account/signup/start)

### Настройка примера

Чтобы настроить пример, сделайте следующее:

   1. Откройте файл **O365-Windows-Phone-Art-Curator.sln** с помощью Visual Studio 2013.
   2. Выполните сборку решения. Функция NuGet Package Restore загрузит сборки, указанные в файле packages.config.
   3. Зарегистрируйте и настройте приложение для использования служб Office 365 (подробности ниже).

### Регистрация приложения для использования API Office 365

Для этого можно использовать средства API Office 365 для Visual Studio (автоматизирующие процесс регистрации). Обязательно скачайте и установите средства API Office 365 из галереи Visual Studio.

**Примечание**. Если при установке пакетов возникают ошибки (например, *Не удается найти "Microsoft.IdentityModel.Clients.ActiveDirectory"*), убедитесь, что локальный путь к решению не слишком длинный. Чтобы устранить эту проблему, переместите решение ближе к корню диска.

   1. В окне обозревателя решений выберите проект **O365-Windows-Phone-Art-Curator** -> Добавить -> Подключенная служба.
   2. Появится диалоговое окно диспетчера служб. Выберите элементы Office 365 и "Зарегистрировать приложение".
   3. В диалоговом окне входа введите имя пользователя и пароль для клиента Office 365. Рекомендуем использовать Сайт разработчика Office 365. Чаще всего это имя пользователя выглядит так: {имя_пользователя}@{клиент}.onmicrosoft.com. Если у вас нет сайта разработчика, вы можете получить Сайт разработчика бесплатно в рамках программы "Преимущества MSDN" или подписаться на бесплатную пробную версию. Обратите внимание, что пользователь должен быть администратором клиента. Скорее всего, у вас уже есть эта роль, если клиент создан в рамках Сайта разработчика Office 365. Кроме того, учетные записи разработчиков обычно ограничены одним входом.
   4. После входа вы увидите список всех служб. Изначально разрешения не выбраны, так как приложение еще не зарегистрировано для использования служб. 
   5. Чтобы зарегистрироваться в службах, используемых в этом примере, выберите следующие разрешения:  
      * (Почта) — *Отправка почты от имени пользователя*
      * (Почта) — *Чтение и создание писем от имени пользователя*
   6. Нажмите кнопку "ОК" в диалоговом окне диспетчера служб.

<a name="build"></a>
## Запуск приложения

После загрузки решения в Visual Studio нажмите клавишу F5, чтобы выполнить сборку и развернуть.

<a name="understand"></a>
## Сведения о коде
   
### Ограничения

Указанные ниже функции не включены в текущую версию.

* Поддержка типов файлов, отличных от PNG и JPG
* Обработка одного сообщения с несколькими вложениями
* Подкачка (извлечение более 50 сообщений)
* Обработка уникальности имен папок
* Папкой отправки должна быть папка верхнего уровня  

<a name="questions-and-comments"></a>
## Вопросы и комментарии

— Если у вас не получается запустить этот пример, [сообщите о проблеме](https://github.com/OfficeDev/O365-WinPhone-ArtCurator/issues).
— Общие вопросы об API Office 365 задавайте на сайте [Stack Overflow](http://stackoverflow.com/). Обязательно помечайте свои вопросы и комментарии тегом [office365].
  
<a name="additional-resources"></a>
## Дополнительные ресурсы

* [Общие сведения о платформе API Office 365](http://msdn.microsoft.com/office/office365/howto/platform-development-overview)
* [Центр разработки для Office](http://dev.office.com/)
* [Art Curator для iOS](https://github.com/OfficeDev/O365-iOS-ArtCurator)
* [Art Curator для Android](https://github.com/OfficeDev/O365-Android-ArtCurator)
* [Art Curator для веб-браузера](https://github.com/OfficeDev/O365-Angular-ArtCurator)

## Авторские права

(c) Корпорация Майкрософт (Microsoft Corporation). Все права защищены.
 

